\noindent For the convenience of the reader, in this section we prove the well known formula of the volume of the group $K(N)$ and show its inverse relation to the volume of its associated adelic locally symmetric space. This is summarized in the following proposition.

\begin{prop}
    Let $K(N)$ be the open compact subgroup of $\GL(n,\A_f)$ given by $K(N) = \prod_p K_p(p^{v_p(N)})$, where $K_p(p^k)=\ker(\GL(n,\Z_p))\to \GL(n,\Z/p^k\Z))$, and let $Y(N)$ be the associated adelic locally symmetric space
    \begin{align*}
        Y(N) = \GL(n,\Q)\backslash (\GL(n,\A)/\SO(n)K(N)).
    \end{align*} 
    Similarly, let $K'(N)$ be the analogous open compact subgroup of $\SL(n,\A_f)$, with adelic locally symmetric space $X(N)$. Then the following formulas hold:
    \begin{align}
        \label{volformula}\vol(K(N)) &= \left(N^{n^2}\prod_{p\mid N}\prod_{k=1}^{n}\left(1-\frac{1}{p^k}\right)\right)^{-1}\\
        \label{relatevol}\vol(K(N)) &= \phi(N)^{-1}\vol(K'(N)).
    \end{align}
    Here $\phi$ is Euler's totient function. Furthermore, let
    $$c(n)\coloneqq \vol(\SL(n,\Z)\backslash(\SL(n,\R)/\SO(n)))^{-1}.$$
    This constant depends only on normalizations of measures. We have the relations
    \begin{align}
        \label{GLnspacevol}\vol(K(N)) &= c(n) \vol(Y(N))^{-1}\\
        \label{SLnspacevol}\vol(K'(N)) &= c(n) \vol(X(N))^{-1}.
    \end{align}
\end{prop}

\begin{proof}
As $K(N) = \prod_p K_p(p^{v_p(N)})$, and the measures respect this decomposition, it is sufficient to compute $\vol(K_p(p^{v_p(N)}))$. Fix $p$, and let $m=v_p(N)$. $K_p(p^m)$ is the kernel of the surjective map $\GL(n,\Z_p)\to\GL(n,\Z_p/p^m\Z_p)\cong \GL(n,\Z/p^m\Z)$. Thus,
$$\GL(n,\Z_p)=\bigsqcup_{a\in\GL(n,\Z/p^m\Z)}(a\cdot K_p(p^m))$$
where we by abuse of notation let $a\in\GL(n,\Z/p^m\Z)$ also denote any lift to $\GL(n,\Z_p)$. Since the cosets are disjoint, and they are homeomorphic through multiplication, they all have the same measure, $\vol(K_p(p^m))$. Since the left-hand side has measure $1$ in our normalization, we get that 
$$\vol(K_p(p^m))=\frac{1}{|\GL(n,\Z/p^m\Z)|}.$$

\noindent To determine $|\GL(n,\Z/p^m\Z)|$, we use the following short exact sequence of finite groups
$$0\to\lbrace I+pA\mid A\in M_n(\Z/p^m\Z)\rbrace\to \GL(n,\Z/p^m\Z)\to \GL(n,\Z/p\Z)\to 0.$$

\noindent The rightmost group has cardinality $\prod_{k=0}^{n-1}(p^n-p^k)$ by counting number of bases, using that $\Z/p\Z$ is a field. The leftmost group is bijective to $\lbrace pA\mid A\in M_n(\Z/p^m\Z)\rbrace$, which is the kernel of $M_n(\Z/p^m\Z)\to M_n(\Z/p\Z)$, induced by the obvious quotient map. These have cardinality $p^{n^2m}$ and $p^{n^2}$ respectively, so their kernel has cardinality $p^{m^2(n-1)}$. Plugging everything in, we get that
\begin{align}\label{localvol}
 |\GL(n,\Z/p^m\Z)|\:&= |\GL(n,\Z/p\Z)|\cdot |\lbrace I+pA\mid A\in M_n(\Z/p^m\Z)\rbrace| \\
&= p^{n^2(m-1)}\prod_{k=0}^{n-1}(p^n-p^k) = (p^{m})^{n^2}\prod_{k=0}^{n-1}\left(1-\frac{1}{p^{n-k}}\right).
\end{align}
Reindexing the product, this establishes formula (\ref{volformula}). For the next formula, running through the same argument for $K'(N)$, we get that
\begin{align}\label{SLnlocalvol}
    \vol(K_p'(p^{m})) = \frac{1}{|\SL(n,\Z/p^m\Z)|}.
\end{align}
As the number of units of $\Z/p^m\Z$ is exactly $\phi(p^m)$, we get that 
\begin{align*}
    |\GL(n,\Z/p^m\Z)| = \phi(p^m) |\SL(n,\Z/p^m\Z)|,
\end{align*}
and this proves (\ref{relatevol}). 

Now, let us relate $\vol(Y(N))$ to $\vol(K(N))$. By combining (\ref{volglsl}) and (\ref{relatevol}), we see that the two latter statements of the proposition are equivalent, and so it is sufficient to prove (\ref{SLnspacevol}). By strong approximation, $X(N) =\Gamma(N)\backslash\SL(n,\R)/\SO(n)$, with $\Gamma(N)$ the classical principal congruence subgroup of level $N$. The fundamental domain of $X(N)$ can be viewed as $[\SL(n,\Z):\Gamma(N)]$ copies of a fundamental domain of $\SL(n,\Z)\backslash \SL(n,\R)/\SO(n)$, and hence
\begin{align*}
    \vol(X(N)) = \vol(\SL(n,\Z)\backslash \SL(n,\R)/\SO(n))[\SL(n,\Z):\Gamma(N)].
\end{align*}
Note that $[\SL(n,\Z):\Gamma(N)] = |\SL(n,\Z/N\Z)|$ essentially by definition of $\Gamma(N)$. By the Chinese remainder theorem and (\ref{SLnlocalvol}), we have that
\begin{align*}
    |\SL(n,\Z/N\Z)| = \prod_{p\mid N}|\SL(n,\Z/p^{v_p(N)}\Z)| = \vol(K'(N))^{-1}.
\end{align*}
This concludes the proof.
\end{proof}

\noindent The proposition immediately implies $\vol(X(N)) = O(N^{n^2-1})$. In particular, we get the inequality
\begin{align*}
    N^{-(n-1)}= O\left(\vol(X(N))^{-\frac{1}{n+1}}\right),
\end{align*}
with which we can rewrite the main theorem into its invariant form (\ref{mytheoreminvar}).
